\section{algorithm}

\begin{algorithm}[t]
\setcounter{lines}{0}

\algline \textbf{Input}: a set of user equipments, i.e. $\mathbf{V}$

\algline \textbf{Initial}: $CS \leftarrow \varnothing$

\algline Sort UEs by its pathloss increasingly.

\textbf{\quad{}\quad{}}$\mathbf{V'} = \{[v_1\medspace v_2 ... v_n] | PL(v_i) \leq PL(v_j) \forall i < j\}$

\algline \textbf{While } $\mathbf{V'}$ is not empty

\algline \textbf{\quad{}} $u = \mathbf{V'}.first()$ \textbackslash\textbackslash select the first element

\algline \textbf{\quad{}For } $r \in \mathbf{V'},\medspace r\neq u$

\algline \textbf{\quad{}}\textbf{\quad{}If } $pair(u,\medspace r)$ is feasible for given constraint

\algline \textbf{\quad{}}\textbf{\quad{}}\textbf{\quad{}} $\mathbf{M} =pair(u,\medspace r).getMCS()$ \textbackslash\textbackslash feasible MCSs

\algline \textbf{\quad{}}\textbf{\quad{}}\textbf{\quad{}For } $W_{m}, m\in \textbf{M}$

\algline \textbf{\quad{}}\textbf{\quad{}}\textbf{\quad{}}\textbf{\quad{}If } $W_{m} > best$

\algline \textbf{\quad{}}\textbf{\quad{}}\textbf{\quad{}}\textbf{\quad{}}\textbf{\quad{}} $best \leftarrow W_{m}$

\algline \textbf{\quad{}}\textbf{\quad{}}\textbf{\quad{}}\textbf{\quad{}}\textbf{\quad{}} $r' \leftarrow r$

\algline \textbf{\quad{}}\textbf{\quad{}}\textbf{\quad{}}\textbf{\quad{}End If}

\algline \textbf{\quad{}}\textbf{\quad{}}\textbf{\quad{}End For}

\algline \textbf{\quad{}}\textbf{\quad{}End For}

\algline \textbf{\quad{}}\textbf{\quad{}If } $v'$ exists \textbackslash\textbackslash $u$ can form a pair.

\algline \textbf{\quad{}}\textbf{\quad{}}\textbf{\quad{}} $\mathbf{V'}\leftarrow \mathbf{V'}\backslash \{r', u\}$, $CS \leftarrow CS \bigcup \{r', u\}$

\algline \textbf{\quad{}}\textbf{\quad{}Else }

\algline \textbf{\quad{}}\textbf{\quad{}}\textbf{\quad{}} $\mathbf{V'}\leftarrow \mathbf{V'}\backslash \{u\}$, $CS \leftarrow CS \bigcup \{u\}$

\algline \textbf{\quad{}}\textbf{\quad{}End If }

\algline \textbf{\quad{}End While}

\algline \textbf{Return} $best,\medspace CS$

\caption{\label{alg_} Scheduling transmission pairs iteratively}
\end{algorithm}


\begin{algorithm}[t]
\setcounter{lines}{0}

\algline \textbf{Input}: a set of secondary users, i.e. $\mathbf{V}$

\algline Partition coalition structures to subspaces:

\textbf{\quad{}\quad{}}$\mathcal{P}_k=\{{\mathcal{S}\in\mathcal{B}_{|\mathbf{V}|}}|\text{pivot user set of }\mathcal{S}\text{ is }A^{\mathcal{P}_k}\}$

\algline calculate upper bounds for each subspaces:

\textbf{\quad{}\quad{}}$U^{(\mathcal{P}_k)}={\sum}_{i\in \mathbf{V}}\underset{\mathcal{G}_k \in \mathcal{L}}{\max}\, U_i(\left.\mathbb{P}_{\text{SHD}}^{(i)}\right|_{\mathcal{G}_k})$

\algline sort $\mathcal{P}_k$ by the value $U^{(\mathcal{P}_k)}$ and rename subspaces by the

\textbf{\quad{}\quad{}}corresponding order so that $U^{(\mathcal{P}_1)}\geq U^{(\mathcal{P}_2)}\geq...$

\algline \textbf{Set} best utility value $U^{(S^{\dagger})}=0$

\algline \textbf{For }subspace $\mathcal{P}_k$, $k=1,2,3,...,$

\algline \textbf{\quad{}If} $U^{(\mathcal{P}_k)}>U^{(S^{\dagger})}$

\algline \textbf{\quad{}\quad{}For} each coalition structure $S\in\mathcal{P}_{k}$

\algline \textbf{\quad{}\quad{}\quad{}If} $U^{(S)}>U^{(S^{\dagger})}$

\algline \textbf{\quad{}\quad{}\quad{}\quad{}}Replace the best:$\mathcal{S}^{\dagger}\leftarrow\mathcal{S}$\textbf{
}and\textbf{ $U^{(\mathcal{S}^{\dagger})}\leftarrow U^{(\mathcal{S})}$}

\algline \textbf{\quad{}\quad{}\quad{}End If}

\algline \textbf{\quad{}\quad{}End For}

\algline \textbf{\quad{}End If}

\algline \textbf{End For }

\algline \textbf{Return} $\mathcal{S}^{*}\leftarrow\mathcal{S}^{\dagger}$

\caption{\label{alg_} Searching the optimal coalition structure}
\end{algorithm}









